# Чат боты для викторины по истории
Проект содержит чат ботов для телеграма и ВКонтакте для проведения викторины по истории. 
Боты выдают и проверяют ответы на вопросы из указанного файла.
## Пример работы бота для телеграма
![](https://github.com/Atmoslayer/quiz-bot/blob/main/demo%20gif/demo_tg_bot.gif) 
## Пример работы бота для ВКонтакте
![](https://github.com/Atmoslayer/quiz-bot/blob/main/demo%20gif/demo_vk_bot.gif)
## Примеры рабочих версий проекта
Проект содержит рабочие версии [телегам бота](https://t.me/HistoricalQuizBot) и бота, подключенного к [группе ВКонтакте](https://vk.com/club220464275).
## Как установить
### Для телеграм бота
Необходимо создать телеграм бота с помощью отца ботов @BotFather, написав ему и выбрав имена для бота. 
После этого будет получен токен, подобный этому: `1234567890:ABCDEFGHIjklmnoPqrsStuvwxyzINet1234`.
Логи работы телеграм бота отсылаются администратору, телеграм id которого можно получить,
написав боту @getmyid_bot.
После этого будет получен id наподобие этого: `1234567891`.
### Для ВК бота
Необходимо создать группу ВКонтакте, разрешить в ней отправлять сообщения в разделе `Сообщения`, там же в подразделе `Настройки для бота`
необходимо включить возможности ботов. Далее необходимо получить токен в разделе
`Работа с API`.
В том же разделе появится токен наподобие этого: `vk1.a.4-Abcdfghij_klmnOp...gdf`.
Логи работы вк бота присылаются администратору, ВК id которого можно получить из ссылки на свою страницу.
Если id пользователя не меняли, обычно это набор цифр наподобие этого: `1234567778`.
### Для базы данных
В качестве базы данных в проекте используется redis. Для получения данных подключения к БД необходимо зарегистрироваться 
на сайте [redislabs](https://redislabs.com/). Возможно, для этого потребуется подключение через VPN. 
Необходимы ссылка на подключение наподобие этой: `redis-1234.asia-northwest1-1.cloud.redislabs.com`,
порт наподобие этого: `12345`, пароль от базы данных наподобие этого: `qjrljfsdfireppnbvmsdfsdklwer`.
### Для работы проекта
Для хранения токенов в проекте используются переменные окружения. После получения токены и путь к json файлу с ключами необходимо добавить в файл `.env`.
Пример заполненного файла:
```
TG_BOT_TOKEN=1234567890:ABCDEFGHIjklmnoPqrsStuvwxyzINet1234
TG_ADMIN_CHAT_ID=1234567891
VK_ADMIN_ID=1234567778
VK_TOKEN=vk1.a.4-Abcdfghij_klmnOp...gdf
HOST=redis-1234.asia-northwest1-1.cloud.redislabs.com
PORT=12345
DB_PASSWORD=qjrljfsdfireppnbvmsdfsdklwer
```
Вопросы для викторины берутся из указываемого файла в формате `txt` c кодировкой `KOI8-R`. Вопросы и ответы в файле должны быть отделены соответствующими
заголовками в следующем формате:
```
Вопрос 1:
С одним советским туристом в Марселе произошел такой случай. Спустившись
из своего номера на первый этаж, он вспомнил, что забыл закрутить кран в
ванной. Когда он поднялся, вода уже затопила комнату. Он вызвал
горничную, та попросила его обождать внизу. В страхе он ожидал расплаты
за свою оплошность. Но администрация его не ругала, а, напротив,
извинилась сама перед ним. За что?

Ответ:
За то, что не объяснила ему правила пользования кранами.
```
Python3 должен быть уже установлен.
Затем используйте `pip` (или `pip3`, если есть конфликт с Python2) для установки зависимостей:
```
pip install -r requirements.txt
```
## Запуск ботов
Путь к файлу с вопросами указывается при запуске с помощью аргумента 
 `--questions_path`. 
### Запуск телеграм бота
Бот запускается командой:
```commandline
python3 telegram_bot.py --questions_path C:\Users\atmoslayer\questions\1vs1200.txt
```
### Запуск ВК бота
Бот запускается командой:
```commandline
python3 vk_bot.py --questions_path C:\Users\atmoslayer\questions\1vs1200.txt
```
### Запуск с помощью docker
Проект содержит dockerfile, позволяющий создать образ и контейнер для проекта.
Docker должен быть установлен и запущен.
Для создания образа используйте `docker build` с указанием имени образа через `-t`:
```commandline
docker build . -t quiz_bot
```
Для создания контейнеров используйте `docker run` с указанием имени контейнера через `--name`, указанием пути к .env файлу чере- `--env-file` 
и аргументом для запуска соответствующего бота.
### Запуск телеграм бота через docker
```commandline
docker run --name telegram_bot --env-file=./.env -it quiz_bot python telegram_bot.py --questions_path C:\Users\atmoslayer\questions\1vs1200.txt
```
### Запуск ВК бота через docker
```commandline
docker run --name vk_bot --env-file=./.env -it quiz_bot python vk_bot.py --questions_path C:\Users\atmoslayer\questions\1vs1200.txt
```
После создания контейнеры с ботами будут запущены и готовы к работе.

## Цель проекта
Код написан в образовательных целях на онлайн-курсе для веб-разработчиков [dvmn.org](https://dvmn.org/).